/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.jobits.pos.ui.venta.orden;

import com.jgoodies.binding.adapter.Bindings;
import com.jgoodies.binding.list.SelectionInList;
import com.jobits.pos.core.domain.models.ProductoVenta;
import com.jobits.pos.core.domain.models.temporal.ProductoVentaWrapper;
import com.jobits.pos.ui.AbstractViewPanel;
import com.jobits.pos.ui.presenters.AbstractViewPresenter;
import static com.jobits.pos.ui.venta.orden.presenter.AgregarProductoViewModel.*;
import static com.jobits.pos.ui.venta.orden.presenter.AgregarProductoViewPresenter.*;
import com.jobits.pos.utils.utils;
import com.jobits.ui.components.MaterialComponentsFactory;
import com.root101.swing.material.standards.MaterialIcons;
import java.awt.Component;
import java.beans.PropertyChangeEvent;
import javax.swing.JList;
import javax.swing.ListCellRenderer;

/**
 *
 * @author Home
 */
public class AgregarProductoView extends AbstractViewPanel {

    public static final String VIEW_NAME = "Agregar Producto";

    /**
     * Creates new form AgregarProductoView
     *
     * @param presenter
     */
    public AgregarProductoView(AbstractViewPresenter presenter) {
        super(presenter);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        jPanel6 = MaterialComponentsFactory.Containers.getSecondaryPanel();
        jPanel1 = MaterialComponentsFactory.Containers.getTransparentPanel();
        jPanel7 = MaterialComponentsFactory.Containers.getTransparentPanel();
        jButtonBack = MaterialComponentsFactory.Buttons.getOutlinedButton();
        jLabel2 = new javax.swing.JLabel();
        jButtonNext = MaterialComponentsFactory.Buttons.getOutlinedButton();
        jScrollPaneProductos = MaterialComponentsFactory.Containers.getScrollPane();
        jListProductosDisponibles = new javax.swing.JList<>();
        jPanel2 = MaterialComponentsFactory.Containers.getSecondaryPanel();
        jPanel4 = MaterialComponentsFactory.Containers.getTransparentPanel();
        jLabel1 = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        jListProductosAgregados = new javax.swing.JList<>()
        ;
        jPanel5 = MaterialComponentsFactory.Containers.getTransparentPanel();
        jButtonEliminar = MaterialComponentsFactory.Buttons.getOutlinedButton();
        jPanel3 = MaterialComponentsFactory.Containers.getPrimaryPanel();
        jButtonCancelar = MaterialComponentsFactory.Buttons.getLinedButton();
        jButtonAgregar = MaterialComponentsFactory.Buttons.getMaterialButton();

        setMaximumSize(new java.awt.Dimension(780, 450));
        setMinimumSize(new java.awt.Dimension(780, 450));
        setOpaque(false);
        setPreferredSize(new java.awt.Dimension(780, 450));
        setLayout(new java.awt.BorderLayout());

        jPanel6.setLayout(new java.awt.BorderLayout());

        jPanel1.setLayout(new java.awt.BorderLayout());

        jPanel7.setLayout(new java.awt.BorderLayout());

        jButtonBack.setIcon(MaterialIcons.ARROW_BACK);
        jButtonBack.setPreferredSize(new java.awt.Dimension(50, 50));
        jPanel7.add(jButtonBack, java.awt.BorderLayout.WEST);

        jLabel2.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel2.setText("<Nombre Seccion>");
        jPanel7.add(jLabel2, java.awt.BorderLayout.CENTER);

        jButtonNext.setIcon(MaterialIcons.ARROW_FORWARD);
        jButtonNext.setPreferredSize(new java.awt.Dimension(50, 50));
        jPanel7.add(jButtonNext, java.awt.BorderLayout.EAST);

        jPanel1.add(jPanel7, java.awt.BorderLayout.NORTH);

        jScrollPaneProductos.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createEmptyBorder(15, 15, 15, 15), "Productos"));
        jScrollPaneProductos.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        jScrollPaneProductos.setFocusable(false);

        jListProductosDisponibles.setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);
        jListProductosDisponibles.setFixedCellHeight(120);
        jListProductosDisponibles.setFixedCellWidth(140);
        jListProductosDisponibles.setFocusable(false);
        jListProductosDisponibles.setLayoutOrientation(javax.swing.JList.HORIZONTAL_WRAP);
        jListProductosDisponibles.setVisibleRowCount(-1);
        jListProductosDisponibles.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jListProductosDisponiblesMouseClicked(evt);
            }
        });
        jListProductosDisponibles.addListSelectionListener(new javax.swing.event.ListSelectionListener() {
            public void valueChanged(javax.swing.event.ListSelectionEvent evt) {
                jListProductosDisponiblesValueChanged(evt);
            }
        });
        jScrollPaneProductos.setViewportView(jListProductosDisponibles);

        jPanel1.add(jScrollPaneProductos, java.awt.BorderLayout.CENTER);

        jPanel6.add(jPanel1, java.awt.BorderLayout.CENTER);

        jPanel2.setBorder(javax.swing.BorderFactory.createEmptyBorder(1, 15, 1, 15));
        jPanel2.setMaximumSize(new java.awt.Dimension(290, 2147483647));
        jPanel2.setMinimumSize(new java.awt.Dimension(290, 149));
        jPanel2.setPreferredSize(new java.awt.Dimension(290, 149));
        jPanel2.setLayout(new java.awt.BorderLayout());

        jPanel4.setLayout(new java.awt.GridBagLayout());

        jLabel1.setText("<Nombre Producto>");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(32, 99, 52, 119);
        jPanel4.add(jLabel1, gridBagConstraints);

        jPanel2.add(jPanel4, java.awt.BorderLayout.PAGE_START);

        jScrollPane1.setHorizontalScrollBarPolicy(javax.swing.ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
        jScrollPane1.setHorizontalScrollBar(null);
        jScrollPane1.setMaximumSize(new java.awt.Dimension(32767, 200));
        jScrollPane1.setPreferredSize(new java.awt.Dimension(259, 200));

        jListProductosAgregados.setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);
        jScrollPane1.setViewportView(jListProductosAgregados);

        jPanel2.add(jScrollPane1, java.awt.BorderLayout.CENTER);

        jPanel5.setLayout(new java.awt.FlowLayout(java.awt.FlowLayout.RIGHT));

        jButtonEliminar.setText("Eliminar");
        jPanel5.add(jButtonEliminar);

        jPanel2.add(jPanel5, java.awt.BorderLayout.PAGE_END);

        jPanel6.add(jPanel2, java.awt.BorderLayout.EAST);

        jPanel3.setMaximumSize(new java.awt.Dimension(2147483647, 50));
        jPanel3.setMinimumSize(new java.awt.Dimension(157, 50));
        jPanel3.setPreferredSize(new java.awt.Dimension(924, 50));
        jPanel3.setLayout(new java.awt.GridBagLayout());

        jButtonCancelar.setText("Cancelar");
        jButtonCancelar.setPreferredSize(new java.awt.Dimension(140, 40));
        jButtonCancelar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonCancelarActionPerformed(evt);
            }
        });
        jPanel3.add(jButtonCancelar, new java.awt.GridBagConstraints());

        jButtonAgregar.setText("Agregar");
        jButtonAgregar.setPreferredSize(new java.awt.Dimension(140, 40));
        jButtonAgregar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonAgregarActionPerformed(evt);
            }
        });
        jPanel3.add(jButtonAgregar, new java.awt.GridBagConstraints());

        jPanel6.add(jPanel3, java.awt.BorderLayout.SOUTH);

        add(jPanel6, java.awt.BorderLayout.CENTER);
    }// </editor-fold>//GEN-END:initComponents

    private void jListProductosDisponiblesValueChanged(javax.swing.event.ListSelectionEvent evt) {//GEN-FIRST:event_jListProductosDisponiblesValueChanged
        jListProductosDisponibles.clearSelection();
        jListProductosDisponibles.revalidate();
        jListProductosDisponibles.repaint();
    }//GEN-LAST:event_jListProductosDisponiblesValueChanged

    private void jButtonCancelarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonCancelarActionPerformed

    }//GEN-LAST:event_jButtonCancelarActionPerformed

    private void jButtonAgregarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonAgregarActionPerformed

    }//GEN-LAST:event_jButtonAgregarActionPerformed

    private void jListProductosDisponiblesMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jListProductosDisponiblesMouseClicked
//        if (evt.getClickCount() > 1) {
//            getPresenter().getOperation(ACTION_AGREGAR_AGREGO).doAction();
//        }
    }//GEN-LAST:event_jListProductosDisponiblesMouseClicked


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jButtonAgregar;
    private javax.swing.JButton jButtonBack;
    private javax.swing.JButton jButtonCancelar;
    private javax.swing.JButton jButtonEliminar;
    private javax.swing.JButton jButtonNext;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JList<ProductoVentaWrapper> jListProductosAgregados;
    private javax.swing.JList<ProductoVenta> jListProductosDisponibles;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPaneProductos;
    // End of variables declaration//GEN-END:variables

    @Override
    public void wireUp() {
        Bindings.bind(jListProductosDisponibles, new SelectionInList<ProductoVenta>(
                getPresenter().getModel(PROP_LISTA_PRODUCTOS_DISPONIBLES),
                getPresenter().getModel(PROP_PRODUCTO_DISPONIBLE_SELECCIONADO)));

        Bindings.bind(jListProductosAgregados, new SelectionInList<ProductoVentaWrapper>(
                getPresenter().getModel(PROP_LISTA_PRODUCTOS_CONTENIDOS),
                getPresenter().getModel(PROP_PRODUCTO_CONTENIDO_SELECCIONADO)));

        Bindings.bind(jLabel1, getPresenter().getModel(PROP_NOMBRE_PRODUCTO));
        Bindings.bind(jLabel2, getPresenter().getModel(PROP_NOMBRE_SECCION_MOSTRADA));

        Bindings.bind(jButtonBack, "visible", getPresenter().getModel(PROP_NAVEGACION_HABILITADA));
        Bindings.bind(jButtonNext, "visible", getPresenter().getModel(PROP_NAVEGACION_HABILITADA));

        jButtonCancelar.addActionListener(getPresenter().getOperation(ACTION_CANCELAR));
        jButtonEliminar.addActionListener(getPresenter().getOperation(ACTION_ELIMINAR_AGREGO));
        jButtonAgregar.addActionListener(getPresenter().getOperation(ACTION_AGREGAR));
        jButtonNext.addActionListener(getPresenter().getOperation(ACTION_SECCION_SIGUIENTE));
        jButtonBack.addActionListener(getPresenter().getOperation(ACTION_SECCION_ANTERIOR));

    }

    @Override
    public void uiInit() {
        initComponents();
        jListProductosDisponibles.setCellRenderer(new ListCellRenderer<ProductoVenta>() {
            @Override
            public Component getListCellRendererComponent(JList<? extends ProductoVenta> list, ProductoVenta value, int index, boolean isSelected, boolean cellHasFocus) {
                return new CellRenderLabel(value.getNombre(), utils.setDosLugaresDecimales(value.getPrecioVenta()), isSelected, value.getDescripcion());
            }
        });
        jListProductosAgregados.setCellRenderer(new ListCellRenderer<ProductoVentaWrapper>() {
            @Override
            public Component getListCellRendererComponent(JList<? extends ProductoVentaWrapper> list,
                    ProductoVentaWrapper value, int index, boolean isSelected, boolean cellHasFocus) {
                return new CellRenderProductoVentaWrapper(value, isSelected);
            }
        });
        getPresenter().addBeanPropertyChangeListener(PROP_LISTA_PRODUCTOS_CONTENIDOS, (PropertyChangeEvent evt) -> {
            jListProductosAgregados.clearSelection();
            jListProductosAgregados.repaint();
            jListProductosAgregados.revalidate();
        });
    }

    @Override
    public String getViewName() {
        return VIEW_NAME;
    }
}
