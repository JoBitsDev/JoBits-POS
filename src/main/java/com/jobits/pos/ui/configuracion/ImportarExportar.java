/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.jobits.pos.ui.configuracion;

import com.jobits.pos.controller.productos.ProductoVentaListController;
import com.jobits.pos.recursos.R;
import com.jobits.pos.ui.AbstractViewPanel;
import com.jobits.pos.ui.presenters.AbstractViewPresenter;
import java.awt.Container;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;
import com.jobits.ui.components.MaterialComponentsFactory;

/**
 *
 * @author Home
 */
public class ImportarExportar extends AbstractViewPanel {

    public static final String VIEW_NAME = "Importar Exportar";

    /**
     * Creates new form ImportarExportar2
     */
    public ImportarExportar(AbstractViewPresenter presenter) {
        super(presenter);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanelImportarExportar = MaterialComponentsFactory.Containers.getSecondaryPanel();
        jPanel2 = MaterialComponentsFactory.Containers.getSecondaryPanel();
        filler3 = new javax.swing.Box.Filler(new java.awt.Dimension(0, 0), new java.awt.Dimension(0, 0), new java.awt.Dimension(0, 32767));
        jPanel3 = MaterialComponentsFactory.Containers.getSecondaryPanel();
        filler5 = new javax.swing.Box.Filler(new java.awt.Dimension(50, 0), new java.awt.Dimension(50, 0), new java.awt.Dimension(50, 32767));
        jLabel2 = MaterialComponentsFactory.Displayers.getLabel();
        filler7 = new javax.swing.Box.Filler(new java.awt.Dimension(260, 0), new java.awt.Dimension(260, 0), new java.awt.Dimension(200, 32767));
        impExpSwitch = MaterialComponentsFactory.Displayers.getComboBox();
        jPanel4 = MaterialComponentsFactory.Containers.getSecondaryPanel();
        filler6 = new javax.swing.Box.Filler(new java.awt.Dimension(50, 0), new java.awt.Dimension(50, 0), new java.awt.Dimension(50, 32767));
        jLabel1 = MaterialComponentsFactory.Displayers.getLabel();
        filler8 = new javax.swing.Box.Filler(new java.awt.Dimension(250, 0), new java.awt.Dimension(255, 0), new java.awt.Dimension(200, 32767));
        itemSelector = MaterialComponentsFactory.Displayers.getComboBox();
        filler4 = new javax.swing.Box.Filler(new java.awt.Dimension(0, 0), new java.awt.Dimension(0, 0), new java.awt.Dimension(0, 32767));
        jPanel1 = MaterialComponentsFactory.Containers.getSecondaryPanel();
        openSaveButton = MaterialComponentsFactory.Buttons.getOutlinedButton();

        setPreferredSize(new java.awt.Dimension(730, 525));

        jPanelImportarExportar.setBorder(javax.swing.BorderFactory.createEmptyBorder(5, 5, 5, 5));
        jPanelImportarExportar.setPreferredSize(new java.awt.Dimension(730, 525));
        jPanelImportarExportar.setLayout(new java.awt.BorderLayout());

        jPanel2.setLayout(new javax.swing.BoxLayout(jPanel2, javax.swing.BoxLayout.PAGE_AXIS));
        jPanel2.add(filler3);

        jPanel3.setLayout(new java.awt.FlowLayout(java.awt.FlowLayout.LEFT));
        jPanel3.add(filler5);

        jLabel2.setFont(new java.awt.Font("Dialog", 1, 18)); // NOI18N
        jLabel2.setText("Opción");
        jPanel3.add(jLabel2);
        jPanel3.add(filler7);

        impExpSwitch.setFont(new java.awt.Font("Dialog", 0, 18)); // NOI18N
        impExpSwitch.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Importar", "Exportar" }));
        impExpSwitch.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                impExpSwitchActionPerformed(evt);
            }
        });
        jPanel3.add(impExpSwitch);

        jPanel2.add(jPanel3);

        jPanel4.setLayout(new java.awt.FlowLayout(java.awt.FlowLayout.LEFT));
        jPanel4.add(filler6);

        jLabel1.setFont(new java.awt.Font("Dialog", 1, 18)); // NOI18N
        jLabel1.setText("Archivo");
        jPanel4.add(jLabel1);
        jPanel4.add(filler8);

        itemSelector.setFont(new java.awt.Font("Dialog", 0, 18)); // NOI18N
        itemSelector.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Ficha de Costo" }));
        jPanel4.add(itemSelector);

        jPanel2.add(jPanel4);
        jPanel2.add(filler4);

        jPanelImportarExportar.add(jPanel2, java.awt.BorderLayout.CENTER);

        openSaveButton.setFont(new java.awt.Font("Dialog", 1, 18)); // NOI18N
        openSaveButton.setText("Abrir");
        openSaveButton.setAutoscrolls(true);
        openSaveButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                openSaveButtonActionPerformed(evt);
            }
        });
        jPanel1.add(openSaveButton);

        jPanelImportarExportar.add(jPanel1, java.awt.BorderLayout.SOUTH);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 730, Short.MAX_VALUE)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                    .addGap(0, 0, Short.MAX_VALUE)
                    .addComponent(jPanelImportarExportar, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGap(0, 0, Short.MAX_VALUE)))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 525, Short.MAX_VALUE)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                    .addGap(0, 0, Short.MAX_VALUE)
                    .addComponent(jPanelImportarExportar, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGap(0, 0, Short.MAX_VALUE)))
        );
    }// </editor-fold>//GEN-END:initComponents

    private void openSaveButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_openSaveButtonActionPerformed
        importarExportar(new ProductoVentaListController());
        // TODO add your handling code here:
    }//GEN-LAST:event_openSaveButtonActionPerformed

    private void impExpSwitchActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_impExpSwitchActionPerformed
        if (impExpSwitch.getSelectedItem().toString().equals("Importar")) {
            openSaveButton.setText("Abrir");
        } else if (impExpSwitch.getSelectedItem().toString().equals("Exportar")) {
            openSaveButton.setText("Guardar");
        }

        // TODO add your handling code here:
    }//GEN-LAST:event_impExpSwitchActionPerformed

    private void importarExportar(ProductoVentaListController prodVentaList) {

        if (itemSelector.getSelectedItem().toString().equals("Ficha de Costo")) {
            if (impExpSwitch.getSelectedItem().toString().equals("Importar")) {
                importProdVentaList(prodVentaList);
            } else if (impExpSwitch.getSelectedItem().toString().equals("Exportar")) {
                exportarProdVentaList(prodVentaList);
            }
        }
    }

    private void importProdVentaList(ProductoVentaListController prodVentaList) {
        JFileChooser list = new JFileChooser();
        int response = list.showOpenDialog(jPanel2);
        if (response == JFileChooser.APPROVE_OPTION) {
            prodVentaList.importarFichadeCostoFromJson(list.getSelectedFile());
            showSuccessDialog(jPanel2, "El archivo se ha exportado con Ã©xito");
        }

    }

    private void exportarProdVentaList(ProductoVentaListController prodVentaList) {
        JFileChooser list = new JFileChooser();
        int response = list.showSaveDialog(jPanel2);
        if (response == JFileChooser.APPROVE_OPTION) {
            prodVentaList.exportarToJson(list.getSelectedFile(), prodVentaList.getItems());
            showSuccessDialog(jPanel2, "El archivo se ha importado con Ã©xito");
        }

    }

    public void showSuccessDialog(Container view, String text) {
        JOptionPane.showMessageDialog(view, text,
                R.RESOURCE_BUNDLE.getString("label_informacion"), JOptionPane.INFORMATION_MESSAGE,
                new javax.swing.ImageIcon(getClass().getResource("/restManager/resources/images/exitoso.png")));

    }

    @Override
    public void wireUp() {
    }

    @Override
    public void uiInit() {
        initComponents();
    }

    @Override
    public String getViewName() {
        return VIEW_NAME;
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.Box.Filler filler3;
    private javax.swing.Box.Filler filler4;
    private javax.swing.Box.Filler filler5;
    private javax.swing.Box.Filler filler6;
    private javax.swing.Box.Filler filler7;
    private javax.swing.Box.Filler filler8;
    private javax.swing.JComboBox<String> impExpSwitch;
    private javax.swing.JComboBox<String> itemSelector;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanelImportarExportar;
    private javax.swing.JButton openSaveButton;
    // End of variables declaration//GEN-END:variables
}
