/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.jobits.pos.ui.imagemanager;

import com.jgoodies.binding.adapter.Bindings;
import com.jobits.pos.ui.AbstractViewPanel;
import com.jobits.pos.ui.DefaultValues;
import static com.jobits.pos.ui.imagemanager.presenter.ImageManagerViewModel.*;
import static com.jobits.pos.ui.imagemanager.presenter.ImageManagerViewPresenter.*;
import com.jobits.pos.ui.presenters.AbstractViewPresenter;
import com.jobits.ui.components.MaterialComponentsFactory;
import java.beans.PropertyChangeEvent;

/**
 *
 * @author Home
 */
public class ImageManagerView extends AbstractViewPanel {

    public static final String VIEW_NAME = "Image Manager";

    /**
     * Creates new form IMageManagerView
     *
     * @param presenter
     */
    public ImageManagerView(AbstractViewPresenter presenter) {
        super(presenter);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jPanel3 = MaterialComponentsFactory.Containers.getPrimaryPanel();
        jButtonClose = MaterialComponentsFactory.Buttons.getOutlinedButton();
        jLabel1 = new javax.swing.JLabel();
        jPanelImageViewer = new javax.swing.JPanel();
        jLabelOldImage = new javax.swing.JLabel();
        jPanel2 = MaterialComponentsFactory.Containers.getPrimaryPanel();
        jButtonOpen = MaterialComponentsFactory.Buttons.getOutlinedButton();
        jButtonCrop = MaterialComponentsFactory.Buttons.getOutlinedButton();
        jButtonSave = MaterialComponentsFactory.Buttons.getOutlinedButton();

        setPreferredSize(new java.awt.Dimension(700, 450));
        setLayout(new java.awt.BorderLayout());

        jPanel1.setLayout(new java.awt.BorderLayout());

        jPanel3.setPreferredSize(new java.awt.Dimension(100, 60));
        jPanel3.setLayout(new java.awt.BorderLayout());

        jButtonClose.setIcon(new javax.swing.ImageIcon(getClass().getResource("/restManager/resources/icons pack/cerrar_indigo.png"))); // NOI18N
        jButtonClose.setToolTipText("");
        jButtonClose.setPreferredSize(new java.awt.Dimension(50, 50));
        jButtonClose.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonCloseActionPerformed(evt);
            }
        });
        jPanel3.add(jButtonClose, java.awt.BorderLayout.EAST);

        jLabel1.setFont(new java.awt.Font("Dialog", 1, 18)); // NOI18N
        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel1.setText("<Producto de Venta>");
        jPanel3.add(jLabel1, java.awt.BorderLayout.CENTER);

        jPanel1.add(jPanel3, java.awt.BorderLayout.PAGE_START);

        jPanelImageViewer.setPreferredSize(new java.awt.Dimension(500, 500));
        jPanelImageViewer.setLayout(new java.awt.BorderLayout());

        jLabelOldImage.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jPanelImageViewer.add(jLabelOldImage, java.awt.BorderLayout.CENTER);

        jPanel1.add(jPanelImageViewer, java.awt.BorderLayout.CENTER);

        jPanel2.setLayout(new java.awt.FlowLayout(java.awt.FlowLayout.CENTER, 40, 5));

        jButtonOpen.setIcon(new javax.swing.ImageIcon(getClass().getResource("/restManager/resources/icons pack/abrir_indigo.png"))); // NOI18N
        jButtonOpen.setToolTipText("Abrir");
        jButtonOpen.setPreferredSize(new java.awt.Dimension(50, 50));
        jButtonOpen.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonOpenActionPerformed(evt);
            }
        });
        jPanel2.add(jButtonOpen);

        jButtonCrop.setIcon(new javax.swing.ImageIcon(getClass().getResource("/restManager/resources/icons pack/recortar_indigo.png"))); // NOI18N
        jButtonCrop.setToolTipText("Recortar");
        jButtonCrop.setPreferredSize(new java.awt.Dimension(50, 50));
        jButtonCrop.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonCropActionPerformed(evt);
            }
        });
        jPanel2.add(jButtonCrop);

        jButtonSave.setIcon(new javax.swing.ImageIcon(getClass().getResource("/restManager/resources/icons pack/guardar_indigo.png"))); // NOI18N
        jButtonSave.setToolTipText("Guardar");
        jButtonSave.setPreferredSize(new java.awt.Dimension(50, 50));
        jButtonSave.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonSaveActionPerformed(evt);
            }
        });
        jPanel2.add(jButtonSave);

        jPanel1.add(jPanel2, java.awt.BorderLayout.SOUTH);

        add(jPanel1, java.awt.BorderLayout.CENTER);
    }// </editor-fold>//GEN-END:initComponents

    private void jButtonCloseActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonCloseActionPerformed
    }//GEN-LAST:event_jButtonCloseActionPerformed

    private void jButtonOpenActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonOpenActionPerformed
    }//GEN-LAST:event_jButtonOpenActionPerformed

    private void jButtonCropActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonCropActionPerformed
    }//GEN-LAST:event_jButtonCropActionPerformed

    private void jButtonSaveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonSaveActionPerformed
    }//GEN-LAST:event_jButtonSaveActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jButtonClose;
    private javax.swing.JButton jButtonCrop;
    private javax.swing.JButton jButtonOpen;
    private javax.swing.JButton jButtonSave;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabelOldImage;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanelImageViewer;
    // End of variables declaration//GEN-END:variables

    @Override
    public void wireUp() {
        Bindings.bind(jLabelOldImage, "icon", getPresenter().getModel(PROP_OLD_IMAGE));
        getPresenter().addBeanPropertyChangeListener(PROP_PANEL_DIBUJO, (PropertyChangeEvent evt) -> {
            PanelDibujo panelDibujo = (PanelDibujo) evt.getNewValue();
            if (panelDibujo != null) {
                dragImage(panelDibujo);
            }
        });
        jButtonOpen.addActionListener(getPresenter().getOperation(ACTION_CARGAR_IMAGEN));
        jButtonCrop.addActionListener(getPresenter().getOperation(ACTION_RECORTAR_IMAGEN));
        jButtonSave.addActionListener(getPresenter().getOperation(ACTION_GUARDAR_IMAGEN));
        jButtonClose.addActionListener(getPresenter().getOperation(ACTION_CERRAR));

    }

    @Override
    public void uiInit() {
        initComponents();
        jPanel3.setVisible(false);
    }

    @Override
    public String getViewName() {
        return VIEW_NAME;
    }

    private void dragImage(PanelDibujo pd) {
        int x = (jPanelImageViewer.getWidth() - pd.getImg().getWidth(null)) / 2;
        int y = (jPanelImageViewer.getHeight() - pd.getImg().getHeight(null)) / 2;
        pd.setLocation(x, y);
        pd.repaint();
        repaint();
        if (jPanelImageViewer.getComponentCount() > 0) {
            jPanelImageViewer.removeAll();
        }
        jPanelImageViewer.add(pd);
    }

}
